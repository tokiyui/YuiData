<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>未回収楽曲チェックツール</title>
    <style>
        h2 {
            display: inline;
            margin-right: 10px;
        }
    </style>
    <script>
        function searchSetlist() {
            var resultDiv = document.getElementById("result");

            // song_f.txtの内容を取得
            var songFileContent = getFileContent("song_y.txt");

            // song_f.txtの内容を行ごとに分割して配列に格納
            var songLines = songFileContent.split("\n");

            // 検索対象ファイルのチェックボックスを取得
            var checkboxes = document.querySelectorAll("input[type='checkbox'][class='setlist-checkbox']");

            // 検索結果を格納するオブジェクトを作成
            var searchResult = {};

            checkboxes.forEach(function(checkbox) {
                if (checkbox.checked) {
                    var filePath = "setlist/" + checkbox.id + ".txt";
                    var setlistContent = getFileContent(filePath);

                    songLines.forEach(function(line) {
                        var songData = line.split(",");
                        var songName = songData[0].trim();

                        if (setlistContent.includes(songName)) {
                            searchResult[songName] = "あり";
                        } else if (!searchResult[songName]) {
                            searchResult[songName] = "なし";
                        }
                    });
                }
            });

            // 検索結果を表示
            resultDiv.innerHTML = "";
            for (var song in searchResult) {
                if (searchResult[song] === "なし") {
                    var result = song + "<br>";
                    resultDiv.innerHTML += result;
                }
            }
        }

        function getFileContent(filePath) {
            // XMLHttpRequestを使用してファイルの内容を非同期で取得する
            var xhr = new XMLHttpRequest();
            xhr.open("GET", filePath, false);
            xhr.send();
            return xhr.responseText;
        }
    </script>
</head>
<body>
    <h1>Setlist Search</h1>
    <input type="checkbox" id="2018081501" class="setlist-checkbox" checked>唯涼祭
    <input type="checkbox" id="2020122401" class="setlist-checkbox" checked>小倉唯 ONLINE クリスマス ライブ 2020 ~Winter Twinkle Magic~<br>
    <h2><strong>10th Anniversary Assemble!!</strong></h2>
    <input type="checkbox" id="2023071701" class="setlist-checkbox" checked>昼公演
    <input type="checkbox" id="2023071702" class="setlist-checkbox" checked>夜公演<br>
    <h2><strong>To the 11'Eleven</strong></h2>
    <input type="checkbox" id="2023112301" class="setlist-checkbox" checked>昼公演
    <input type="checkbox" id="2023112302" class="setlist-checkbox" checked>夜公演<br>
    <button onclick="searchSetlist()">検索</button>
    <div id="result"></div>
</body>
</html>
