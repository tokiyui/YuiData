<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>データ検索</title>
</head>
<body>
    <h1>データ検索</h1>
    <label for="year">年:</label>
    <select id="year">
        <option value="">-- 選択してください --</option>
    </select>
    <label for="month">月:</label>
    <select id="month">
        <option value="">-- 選択してください --</option>
    </select>
    <label for="day">日:</label>
    <select id="day">
        <option value="">-- 選択してください --</option>
    </select>
    <!-- 他の項目に対する選択肢も同様に作成 -->

    <button onclick="searchData()">検索</button>

    <div id="searchResults"></div>

    <script>
        function populateSelectOptions(selectId, options) {
            var select = document.getElementById(selectId);
            options.forEach(option => {
                var optionElement = document.createElement("option");
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });
        }

        function searchData() {
            var year = document.getElementById("year").value;
            var month = document.getElementById("month").value;
            var day = document.getElementById("day").value;
            // 他の選択肢に対する値も同様に取得

            var searchResults = document.getElementById("searchResults");
            searchResults.innerHTML = "";

            fetch("test.txt")
                .then(response => response.text())
                .then(data => {
                    var lines = data.split("\n");
                    lines.shift(); // ヘッダー行を削除
                    lines.forEach(line => {
                        var columns = line.split(",");
                        var dataYear = columns[0];
                        var dataMonth = columns[1];
                        var dataDay = columns[2];
                        // 他の条件に合うかどうかを確認
                        if ((year === "" || dataYear === year) &&
                            (month === "" || dataMonth === month) &&
                            (day === "" || dataDay === day)) {
                            var resultRow = document.createElement("p");
                            resultRow.textContent = line;
                            searchResults.appendChild(resultRow);
                        }
                    });
                })
                .catch(error => console.error("Error:", error));
        }

        // 年、月、日の選択肢を動的に生成
        var years = [];
        var months = [];
        var days = [];

        fetch("test.txt")
            .then(response => response.text())
            .then(data => {
                var lines = data.split("\n");
                lines.shift(); // ヘッダー行を削除
                lines.forEach(line => {
                    var columns = line.split(",");
                    var dataYear = columns[0];
                    var dataMonth = columns[1];
                    var dataDay = columns[2];
                    if (!years.includes(dataYear)) {
                        years.push(dataYear);
                    }
                    if (!months.includes(dataMonth)) {
                        months.push(dataMonth);
                    }
                    if (!days.includes(dataDay)) {
                        days.push(dataDay);
                    }
                });

                populateSelectOptions("year", years);
                populateSelectOptions("month", months);
                populateSelectOptions("day", days);
            })
            .catch(error => console.error("Error:", error));
    </script>
</body>
</html>
