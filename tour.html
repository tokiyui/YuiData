<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>セットリスト</title>
<style>
table {
    border-collapse: collapse;
    width: 100%;
}

table, th, td {
    border: 1px solid black;
    padding: 8px;
}

th {
    background-color: #f2f2f2;
}
</style>
</head>
<body>

<h1>セットリスト</h1>
<table id="setlist-table">
    <thead>
        <tr>
            <th>曲名</th>
            <!-- setlist/以下にあるtxtファイルの数だけヘッダを生成 -->
        </tr>
    </thead>
    <tbody>
        <!-- setlistの内容がここに表示されます -->
    </tbody>
</table>

<script>
document.addEventListener('DOMContentLoaded', async function() {
    const checkboxesContainer = document.getElementById('checkboxes');
    const response = await fetch('https://api.github.com/repos/tokiyui/YuiData/contents/setlist');
    const data = await response.json();
    data.forEach((file, index) => {
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `setlist${index + 1}`;
        const label = document.createElement('label');
        label.htmlFor = `setlist${index + 1}`;
        label.textContent = `setlist${index + 1}.txt`;
        checkboxesContainer.appendChild(checkbox);
        checkboxesContainer.appendChild(label);
        checkboxesContainer.appendChild(document.createElement('br'));
    });

    // チェックボックスの状態を取得
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    const checkedIndexes = Array.from(checkboxes).map((checkbox, index) => checkbox.checked ? index : null).filter(index => index !== null);

    // setlistの内容を表示
    const table = document.getElementById('setlist-table');
    const tbody = table.querySelector('tbody');

    // チェックされたtxtファイルの本文2行目を取得して表示
    await Promise.all(checkedIndexes.map(async index => {
        const response = await fetch(`https://raw.githubusercontent.com/tokiyui/YuiData/master/setlist/setlist${index + 1}.txt`);
        const text = await response.text();
        const lines = text.split('\n');
        const secondLine = lines.length > 1 ? lines[1].trim() : ''; // 2行目のみ取得
        const row = document.createElement('tr');
        const cell = document.createElement('td');
        cell.textContent = secondLine;
        row.appendChild(cell);
        tbody.appendChild(row);
    }));
});
</script>

</body>
</html>
