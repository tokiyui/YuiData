<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>セットリスト</title>
</head>
<body>

<select id="concertSelect">
  <option value="" disabled selected>セットリストを選択してください</option>
  <option value="小倉唯 1st LIVE「HAPPY JAM」">小倉唯 1st LIVE「HAPPY JAM」</option>
  <option value="小倉唯 1st LIVE TOUR「High-Touch☆Summer」">小倉唯 1st LIVE TOUR「High-Touch☆Summer」</option>
  <option value="小倉唯 LIVE「Smiley Cherry」">小倉唯 LIVE「Smiley Cherry」</option>
  <option value="小倉唯 2nd LIVE TOUR「Platinum Airline☆」">小倉唯 2nd LIVE TOUR「Platinum Airline☆」</option>
  <option value="小倉唯 LIVE TOUR 2019「Step Apple」">小倉唯 LIVE TOUR 2019「Step Apple」</option>
  <option value="小倉唯 LIVE 2021「#Re♥LOVEcall」">小倉唯 LIVE 2021「#Re♥LOVEcall」</option>
  <option value="小倉唯 Memorial LIVE 2023 ~To the 11'Eleven~">小倉唯 Memorial LIVE 2023 ~To the 11'Eleven~</option>
  <option value="小倉唯 Memorial LIVE 2023 ~10th Anniversary Assemble!!~">小倉唯 Memorial LIVE 2023 ~10th Anniversary Assemble!!~</option>
  <option value="KING SUPER LIVE">KING SUPER LIVE</option>
  <option value="Animelo Summer Live">Animelo Summer Live</option>
  <option value="ANIMAX MUSIX">ANIMAX MUSIX</option>
</select>

<div id="setlistContainer"></div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const concertSelect = document.getElementById('concertSelect');
    const setlistContainer = document.getElementById('setlistContainer');

    concertSelect.addEventListener('change', function() {
        const selectedConcert = concertSelect.value;
        setlistContainer.innerHTML = ''; // Clear previous setlist

        fetchSetlist(selectedConcert);
    });

    function fetchSetlist(selectedConcert) {
        fetch('setlist/')
            .then(response => response.json())
            .then(data => {
                const setlists = data.filter(setlist => setlist.includes(selectedConcert));

                if (setlists.length > 0) {
                    setlists.forEach(setlist => {
                        fetch(`setlist/${setlist}`)
                            .then(response => response.text())
                            .then(data => {
                                const lines = data.split('\n');
                                const date = lines[0].trim();
                                const title = lines[1].trim();
                                const venue = lines[2].trim();

                                let formattedDate = new Date(date).toLocaleDateString('ja-JP', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                                setlistContainer.innerHTML += `<p>${formattedDate}</p>`;
                                setlistContainer.innerHTML += `<p><strong>${title}</strong></p>`;
                                setlistContainer.innerHTML += `<p>@${venue}</p>`;

                                for (let i = 4; i < lines.length; i++) {
                                    const line = lines[i].trim();
                                    if (line !== '' && !line.startsWith('<')) {
                                        setlistContainer.innerHTML += `<p>${line}</p>`;
                                    }
                                }
                            })
                            .catch(error => console.error('Error fetching setlist:', error));
                    });
                } else {
                    setlistContainer.innerHTML = '<p>No setlist found for the selected concert.</p>';
                }
            })
            .catch(error => console.error('Error fetching setlist index:', error));
    }
});
</script>

</body>
</html>
