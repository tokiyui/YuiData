<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Content Display</title>
</head>
<body>
    <div id="output">
        <?php
            // URLからnameパラメーターの値を取得
            $searchString = $_GET['name'];
            echo "<h2>Search String: $searchString</h2>";

            // setlistディレクトリ内のファイルを検索して、指定された文字列を含むファイルの内容を表示する関数
            function searchFilesAndDisplayContent($searchString) {
                $directory = 'setlist/';
                $files = scandir($directory);
                foreach ($files as $file) {
                    if ($file === '.' || $file === '..') {
                        continue;
                    }
                    $filePath = $directory . $file;
                    $fileContent = file_get_contents($filePath);
                    if (strpos($fileContent, $searchString) !== false) {
                        // ファイルの内容から最初の2行を取得
                        $lines = explode("\n", $fileContent);
                        $content = implode('<br>', array_slice($lines, 0, 2));
                        echo "<h3>$file</h3>";
                        echo $content . '<hr>';
                    }
                }
            }

            // ディレクトリ内のファイルを検索して表示
            searchFilesAndDisplayContent($searchString);
        ?>
    </div>
</body>
</html>
